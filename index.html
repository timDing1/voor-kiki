<!doctype html>
<html lang="nl">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Voor jou 💫</title>
  <meta name="description" content="Een kleine, lieve, interactieve liefdesbrief als webapp 😘" />
  <meta name="theme-color" content="#0e1622" />
  <link rel="icon" href="data:image/svg+xml,<svg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 100 100'><text y='0.9em' font-size='90'>💌</text></svg>">
  <style>
    :root{
      --text:#f9fafb;
      --muted:#cbd5e1;
      --accent:#ef476f;
      --radius:18px;
      --glass: rgba(255,255,255,.08);
      --glass-border: rgba(255,255,255,.2);
      --cx: 50%;
      --cy: 50%;
      --r: 150vmax;
    }
    html,body{height:100%}
    body{
      margin:0;
      font-family: system-ui, -apple-system, "Segoe UI", Roboto, Helvetica, Arial, sans-serif;
      color: var(--text);
      background: radial-gradient(ellipse at bottom, #1b2735 0%, #090a0f 100%);
      overflow-x:hidden;
    }
    .hidden{opacity:0; pointer-events:none; transform: scale(.98); transition: opacity .6s ease, transform .6s ease}
    .show{opacity:1; transform: none}
    .sr-only{position:absolute;width:1px;height:1px;padding:0;margin:-1px;overflow:hidden;clip:rect(0,0,0,0);white-space:nowrap;border:0}

    /* Reduced motion toggle */
    .reduce-motion *{ animation: none !important; transition: none !important; }

    /* INTRO */
    .intro{
      position:fixed; inset:0; display:grid; place-items:center; z-index:20;
      background: radial-gradient(ellipse at bottom, #0e1622 0%, #07080d 100%);
      clip-path: circle(var(--r) at var(--cx) var(--cy));
      transition: clip-path 900ms cubic-bezier(.2,.8,.2,1), opacity .6s ease;
    }
    .intro.explode{ --r: 0vmax; opacity: 0; }
    .intro .box{
      text-align:center; padding: clamp(20px, 5vw, 48px);
      border-radius: 22px; backdrop-filter: blur(12px);
      background: rgba(255,255,255,.06); border:1px solid var(--glass-border);
      box-shadow: 0 20px 60px rgba(0,0,0,.45);
      max-width: 820px; margin: 0 16px;
      animation: floaty 6s ease-in-out infinite alternate;
    }
    @keyframes floaty{ from{ transform: translateY(0) } to{ transform: translateY(-6px) } }
    .intro h1{margin:0 0 .4rem 0; font-size: clamp(28px, 5vw, 40px)}
    .intro p{margin:.4rem 0; color: var(--muted)}
    .intro .cta{
      margin-top:1.2rem; padding:.9rem 1.2rem; font-weight:800; font-size:1rem;
      border-radius:14px; border:none; cursor:pointer;
      background: linear-gradient(180deg, #ffdbe6, #ffc5d7); color:#7b1233;
      box-shadow: 0 10px 30px rgba(239,71,111,.25);
      transition: transform .15s ease; 
    }
    .intro .cta:hover{ transform: translateY(-2px) }
    .intro .mini{ margin-top:.9rem; font-size:.92rem; color:#ffd6f3; font-style: italic }

    /* STARS */
    .stars, .stars2, .stars3{ position:fixed; inset:0; z-index:0; pointer-events:none; overflow:hidden }
    .stars span, .stars2 span, .stars3 span{
      position:absolute; border-radius:50%; background:#fff; opacity:.85;
      box-shadow: 0 0 6px 2px rgba(255,255,255,.65), 0 0 20px rgba(173,216,255,.35);
      animation: twinkle 4s ease-in-out infinite alternate;
    }
    .stars2 span{ opacity:.9; box-shadow:0 0 8px 3px rgba(255,255,255,.7), 0 0 30px rgba(173,216,255,.45) }
    .stars3 span{ opacity:1; box-shadow: 0 0 10px 4px rgba(255,255,255,.8), 0 0 40px rgba(255,200,250,.5) }
    @keyframes twinkle{ from{opacity:.5; transform: translateY(0) scale(.9)} to{opacity:1; transform: translateY(-2px) scale(1.15)} }
    .stars{ animation: drift1 60s linear infinite }
    .stars2{ animation: drift2 90s linear infinite }
    .stars3{ animation: drift3 120s linear infinite }
    @keyframes drift1{ from{transform:translateY(0)} to{transform:translateY(-30px)} }
    @keyframes drift2{ from{transform:translateY(0)} to{transform:translateY(-45px)} }
    @keyframes drift3{ from{transform:translateY(0)} to{transform:translateY(-60px)} }

    /* Shooting stars */
    .streak{
      position:fixed; width:2px; height:2px; background:linear-gradient(90deg, rgba(255,255,255,0), rgba(255,255,255,1));
      filter: drop-shadow(0 0 6px white);
      transform: rotate(-20deg);
      animation: shoot 1.2s ease-out forwards;
      z-index:1; pointer-events:none;
    }
    @keyframes shoot{ 0%{opacity:0; transform: translate(-10vw,-10vh) rotate(-20deg) scaleX(1)} 10%{opacity:1} 100%{opacity:0; transform: translate(60vw, 40vh) rotate(-20deg) scaleX(40)} }

    /* Burst stars */
    .burst-star{
      position: fixed; width:3px; height:3px; background:white; border-radius:50%;
      box-shadow: 0 0 6px 2px rgba(255,255,255,.7);
      animation: burst 700ms ease-out forwards;
      z-index: 25; pointer-events:none;
    }
    @keyframes burst{ from{opacity:1; transform: translate(0,0) scale(1)} to{opacity:0; transform: translate(var(--tx), var(--ty)) scale(0.5)} }

    /* APP */
    .wrap{ min-height:100dvh; display:grid; place-items:center; padding: clamp(16px, 4vw, 48px); position:relative; z-index:5 }
    .card{
      width:min(920px, 100%); background: var(--glass); border:1px solid var(--glass-border);
      border-radius: var(--radius); box-shadow: 0 20px 60px rgba(0,0,0,.45); backdrop-filter: blur(12px);
      overflow:hidden; opacity:0; transform: translateY(8px) scale(.985); filter: blur(8px);
      transition: opacity .6s ease, transform .6s ease, filter .6s ease;
    }
    .card.app-enter{ opacity:1; transform:none; filter: blur(0) }
    header{ padding:clamp(16px,3vw,28px) clamp(16px,4vw,40px); display:flex; align-items:center; gap:14px; border-bottom:1px dashed rgba(255,255,255,.15)}
    header .emoji{ font-size: clamp(34px, 5vw, 50px) }
    header h1{ margin:0; font-size:clamp(22px,4.5vw,34px) }
    header small{ color: var(--muted) }
    main{ padding:clamp(18px,4vw,44px); display:grid; gap:28px }
    @media (min-width: 840px){ main{ grid-template-columns: 1.2fr .8fr; align-items:start } }

    .panel{ background: rgba(255,255,255,.06); border:1px solid rgba(255,255,255,.15); border-radius: calc(var(--radius) - 6px); padding: clamp(14px,2.5vw,24px) }
    .type{ font-size:clamp(18px,3.6vw,22px); line-height:1.6 }
    .muted{ color:var(--muted) }

    .btns{ display:flex; flex-wrap:wrap; gap:10px; align-items:center }
    .btns-center{ justify-content:center }
    button, .chip{
      appearance:none; border:none; padding:.7rem 1rem; border-radius:12px; background:#f5f6f7; color:#111;
      cursor:pointer; font-weight:700; box-shadow: inset 0 -2px 0 rgba(0,0,0,.05); transition:.2s transform,.2s filter
    }
    button:hover{ transform: translateY(-2px) }
    .primary{ background: linear-gradient(180deg, #ffdbe6, #ffc5d7); color:#8b1b3f }
    .good{ background: linear-gradient(180deg, #dcffe6, #bff5d7); color:#0e6b4b }
    .chip{ font-size:.85rem }

    details{ border:1px dashed rgba(255,255,255,.25); border-radius:12px; padding:.7rem 1rem; color:#fff }
    details[open]{ background: rgba(255,255,255,.05) }

    .footer{ padding: 8px 18px 24px; text-align:center; color:var(--muted) }

    /* Hearts */
    .bg{ position: fixed; inset:0; pointer-events:none; z-index:4; overflow:hidden }
    .heart{ position:absolute; font-size:12px; opacity:0; animation: float 6s linear forwards }
    @keyframes float{ 0%{ transform: translateY(20px) scale(.6) rotate(0deg); opacity:0 } 12%{ opacity:.85 } 100%{ transform: translateY(-110vh) scale(1.3) rotate(18deg); opacity:0 } }
    .secret{ display:none; margin-top:10px; font-size:1.05rem }
    .toast{ position: fixed; left:50%; transform: translateX(-50%); bottom: 18px; background: rgba(255,255,255,.12); border:1px solid rgba(255,255,255,.25); padding:.6rem 1rem; border-radius:999px; box-shadow: 0 10px 30px rgba(0,0,0,.4); z-index: 9; display:none; color:white }

    /* Brief */
    .letter{ line-height:1.75; font-size:1.02rem }
    .letter h4{ margin:.2rem 0 .6rem 0; font-size:1.1rem; color:#ffd6f3 }
    .letter p{ margin:.7rem 0 }
    .letter .sign{ margin-top:.8rem; color: var(--muted); font-style: italic }

    .sterrenquote{ font-style: italic; color:#ffd6f3; margin-top: .8rem; text-align:center; font-size:1.1rem; animation: fadein 2.5s ease }
    @keyframes fadein{ from{opacity:0} to{opacity:1} }

    /* Players grid */
    .players-wrap{
      display:grid; gap:10px; margin-top:.6rem;
      grid-template-columns: 1fr;
    }
    @media (min-width: 720px){
      .players-wrap{ grid-template-columns: 1fr 1fr }
    }
  </style>
</head>
<body>
  <a class="sr-only" href="#main">Direct naar inhoud</a>
  <!-- INTRO -->
  <div class="intro show" id="intro" aria-labelledby="introTitle" aria-describedby="introDesc">
    <div class="stars" id="stars_i" aria-hidden="true"></div>
    <div class="stars2" id="stars2_i" aria-hidden="true"></div>
    <div class="stars3" id="stars3_i" aria-hidden="true"></div>
    <div class="box" role="dialog" aria-modal="true">
      <h1 id="introTitle">Goedemorgen, <span id="introNaam">lieve Kiki</span> ✨</h1>
      <p id="introDesc">Ik kan helaas niet naar je toe komen, maar wel iets naar je toe sturen.</p>
      <p class="mini">Wakker worden onder deze digitale sterren, die ik zelf op de juiste plek heb gezet</p>
      <button class="cta" id="startBtn" aria-controls="app">Klik NU, doe dan</button>
    </div>
  </div>

  <!-- STARS -->
  <div class="stars" id="stars" aria-hidden="true"></div>
  <div class="stars2" id="stars2" aria-hidden="true"></div>
  <div class="stars3" id="stars3" aria-hidden="true"></div>

  <!-- Hearts layer -->
  <div class="bg" id="bg" aria-hidden="true"></div>

  <!-- APP -->
  <div class="wrap" id="app">
    <article class="card" id="card" role="main" aria-live="polite">
      <header>
        <div class="emoji" aria-hidden="true">💌</div>
        <div>
          <h1 id="main">Voor <span id="naam">jou</span> <small class="muted">(aka Ding, schatje, sletje en alles daartussen)</small></h1>
        </div>
      </header>

      <main>
        <section class="panel" aria-live="polite">
          <p class="type" id="type">
            Hey <strong id="typeName">Kiki</strong> 🫶<br/><br/>
            Geen fysiek cadeautje, je favoriete chocolade of een mislukte poging om iets als verrassing bij je thuis te laten komen. Dit keer een digitaal gemaakt stukje liefde, waarvan ik zeker weet dat het aankomt 🙂<br/><br/>
            Het is niet uitgebreid, maar wel speciaal voor jou gebouwd. De eerste stap naar de machine om de tijd stil te kunnen zetten.
          </p>
          <p class="sterrenquote" aria-live="polite">✨✨</p>

          <div class="btns btns-center" id="ctaBtns">
            <button class="primary" id="openBtn">Ontvang kusjes 💋</button>
            <button class="good" id="secretBtn" title="pssst" aria-expanded="false" aria-controls="secret">Geheime boodschap 🔐</button>
            <button class="chip" id="shareBtn" title="Deel deze pagina">Delen ↗︎</button>
          </div>

          <p class="secret" id="secret">Een dergelijk iets was dus een ideetje dat ik een keer wilde maken voor je, maar ik vind dat je dit vandaag verdient.</p>
        </section>

        <!-- KLEINE EXTRA'S -->
        <aside class="panel" id="extras" aria-label="Kleine extra's">
          <h3 style="margin-top:0">Kleine extra's</h3>

          <details>
            <summary>Onze playlist 🎵</summary>
            <div class="players-wrap">
              <iframe style="border-radius:12px" src="https://open.spotify.com/embed/track/0Q6PoJX8JWndVLcJnM1BLX"
                width="100%" height="152" frameborder="0"
                allow="autoplay; clipboard-write; encrypted-media; fullscreen; picture-in-picture" loading="lazy" title="Stop De Tijd"></iframe>
              <iframe style="border-radius:12px" src="https://open.spotify.com/embed/track/25cvMotloW6bJCSP0hKG59"
                width="100%" height="152" frameborder="0"
                allow="autoplay; clipboard-write; encrypted-media; fullscreen; picture-in-picture" loading="lazy" title="Zij Laat Me Praten"></iframe>
              <iframe style="border-radius:12px" src="https://open.spotify.com/embed/track/4osLdgj5ToLMc8EovfWFjx"
                width="100%" height="152" frameborder="0"
                allow="autoplay; clipboard-write; encrypted-media; fullscreen; picture-in-picture" loading="lazy" title="Zoveel Liefde"></iframe>
              <iframe style="border-radius:12px" src="https://open.spotify.com/embed/track/6Mwcn4IEsarl0gDqJ29XFy"
                width="100%" height="152" frameborder="0"
                allow="autoplay; clipboard-write; encrypted-media; fullscreen; picture-in-picture" loading="lazy" title="Platonisch"></iframe>
            </div>
          </details>

          <details>
            <summary>Onze agenda 📅</summary>
            <ul style="list-style:none; padding-left:0; margin:.6rem 0 0 0">
              <li style="margin:.5rem 0; padding:.6rem .8rem; border:1px solid rgba(255,255,255,.15); border-radius:10px; background:rgba(255,255,255,.05);">
                <strong>Weekendje Amsterdam</strong> — <span class="muted">1 &amp; 2 november</span>
              </li>
              <li style="margin:.5rem 0; padding:.6rem .8rem; border:1px solid rgba(255,255,255,.15); border-radius:10px; background:rgba(255,255,255,.05);">
                <strong>Samen acteerkunsten Kiki bekijken</strong> — <span class="muted">3 november</span>
              </li>
              <li style="margin:.5rem 0; padding:.6rem .8rem; border:1px solid rgba(255,255,255,.15); border-radius:10px; background:rgba(255,255,255,.05);">
                <strong>Weekendje bij Tim thuis</strong> — <span class="muted">7, 8 &amp; 9 november</span>
              </li>
              <li style="margin:.5rem 0; padding:.6rem .8rem; border:1px solid rgba(255,255,255,.15); border-radius:10px; background:rgba(255,255,255,.05);">
                <strong>Tripje naar Dublin</strong> — <span class="muted">5, 6, 7 &amp; 8 december</span>
              </li>
            </ul>
          </details>

          <details>
            <summary>Instellingen ⚙️</summary>
            <label style="display:flex;align-items:center;gap:.6rem"><input type="checkbox" id="rmToggle"> Minder animatie (rustige modus)</label>
          </details>
        </aside>

        <!-- BRIEF -->
        <section class="panel letter" id="brief">
          <h3 style="margin-top:0">Speciaal voor vandaag</h3>
          <h4>Aller-allerliefste Kiki Dingewolfs,</h4>

          <p>Ik denk dat ik alles al gezegd heb, maar je hebt vannacht nóg net even wat extra door mijn hoofd gespookt. Waarna ik vervolgens nu ben begonnen aan dit berichtje. Dus bij deze nogmaals, omdat ik het belangrijk vind dat je weet wat je voor mij betekent.</p>

          <p>Ik vind het zo fijn om met je te zijn. Je brengt zoveel warmte en echt iets bijzonders.</p>

          <p>De situatie is nou eenmaal lastig, toch geniet ik van wat we samen hebben. We hebben misschien ‘niets’, maar tegelijk voelt het als alles. We zijn geen ‘wij’ in woorden en in ons verstand, maar wel in gevoel.</p>

          <p>Ik baal enorm als ik je een onaangenaam gevoel geef, dat is nooit mijn bedoeling. Integendeel: ik wil je juist betrekken in mijn leven en je laten voelen dat je belangrijk voor me bent. 
          Ik ben blij dat je er bent en deel uitmaakt van mijn dagen. Dat maakt me gelukkig. Ik weet in wat voor situatie we zitten, maar ik weet ook dat er iets echts tussen ons is. Iets dat niet vanzelfsprekend is. Juist door deze verhouding denk ik dat dergelijke momenten zijn gebeurd.</p>

          <p>Je verdient het mooiste, Kiek. Wat er ook mag gebeuren, ik gun je alles. Met of zonder mij. Onze oprechte momenten betekenen veel voor me, en dat wil ik koesteren.</p>

          <p class="sign">— van mij, voor jou 💗</p>
        </section>

      </main>

      <div class="footer">
        Gemaakt met 💗 — <span class="muted">(C) <span id="year"></span> kom NU dan</span>
      </div>
    </article>
  </div>

  <div class="toast" id="toast" role="status" aria-live="assertive">Geheime mode geactiveerd 😎</div>

  <script>
    /* Personalisatie */
    const params = new URLSearchParams(location.search);
    const naamParam = params.get('naam');
    if (naamParam) {
      const n = decodeURIComponent(naamParam);
      document.getElementById('naam').textContent = n;
      document.getElementById('introNaam').textContent = n;
      document.getElementById('typeName').textContent = n;
      document.title = `Voor ${n} 💫`;
      try { localStorage.setItem('naam', n); } catch {}
    } else {
      try {
        const saved = localStorage.getItem('naam');
        if (saved) {
          document.getElementById('naam').textContent = saved;
          document.getElementById('introNaam').textContent = saved;
          document.getElementById('typeName').textContent = saved;
          document.title = `Voor ${saved} 💫`;
        }
      } catch {}
    }

    /* Jaar */
    document.getElementById('year').textContent = new Date().getFullYear();

    /* Stars seeding */
    function seedStars(container, count, sizeMin=1, sizeMax=2.2){
      for(let i=0;i<count;i++){
        const s=document.createElement('span');
        const size = sizeMin + Math.random()*(sizeMax-sizeMin);
        s.style.width = s.style.height = `${size}px`;
        s.style.left = `${Math.random()*100}%`;
        s.style.top  = `${Math.random()*100}%`;
        s.style.animationDelay = `${Math.random() * 5}s`;
        container.appendChild(s);
      }
    }
    seedStars(document.getElementById('stars'),   140, 1, 2.2);
    seedStars(document.getElementById('stars2'),  90,  1.5, 2.8);
    seedStars(document.getElementById('stars3'),  60,  2, 3.4);

    seedStars(document.getElementById('stars_i'),  60, 1, 2);
    seedStars(document.getElementById('stars2_i'), 40, 1.2, 2.4);
    seedStars(document.getElementById('stars3_i'), 25, 1.6, 3);

    /* Shooting stars */
    let shootTimer;
    function shootingStar(){
      const s = document.createElement('div');
      s.className='streak';
      s.style.left = `${-10 + Math.random()*20}vw`;
      s.style.top  = `${-10 + Math.random()*30}vh`;
      document.body.appendChild(s);
      setTimeout(()=> s.remove(), 1300);
    }
    function startShooting(){
      stopShooting();
      shootTimer = setInterval(()=> { if (Math.random() < 0.6) shootingStar() }, 3500);
    }
    function stopShooting(){ if (shootTimer) clearInterval(shootTimer); }

    /* Hearts */
    const bg = document.getElementById('bg');
    function dropHearts(count = 18) {
      for (let j = 0; j < count; j++) {
        const span = document.createElement('span');
        span.className = 'heart';
        span.textContent = ['❤','💕','💖','💘','💗'][Math.floor(Math.random()*5)];
        span.style.left = Math.random()*100 + 'vw';
        span.style.bottom = '-20px';
        span.style.fontSize = (10 + Math.random()*26) + 'px';
        span.style.animationDuration = (4 + Math.random()*4) + 's';
        bg.appendChild(span);
        setTimeout(() => span.remove(), 7000);
      }
    }
    // Ambient hearts na intro
    let ambientHearts;
    function startAmbientHearts(){ ambientHearts = setInterval(()=> dropHearts(2), 2600) }
    function stopAmbientHearts(){ clearInterval(ambientHearts) }

    /* Buttons */
    const secret = document.getElementById('secret');
    const secretBtn = document.getElementById('secretBtn');
    secretBtn.addEventListener('click', () => {
      const shown = secret.style.display === 'block';
      secret.style.display = shown ? 'none' : 'block';
      secretBtn.setAttribute('aria-expanded', String(!shown));
    });

    /* Toast */
    const toast = document.getElementById('toast');
    function showToast(msg){ toast.textContent = msg; toast.style.display='block'; setTimeout(()=> toast.style.display='none', 2200) }

    /* Konami */
    const K = ['ArrowUp','ArrowUp','ArrowDown','ArrowDown','ArrowLeft','ArrowRight','ArrowLeft','ArrowRight','b','a'];
    let buffer = [];
    window.addEventListener('keydown', (e) => {
      buffer.push(e.key);
      if (buffer.length > K.length) buffer.shift();
      if (K.every((k, i) => buffer[i]?.toLowerCase() === k.toLowerCase())) {
        buffer = [];
        showToast('Geheime mode geactiveerd 😎');
        dropHearts(60);
        const extra = document.createElement('p');
        extra.className = 'secret';
        extra.style.display = 'block';
        extra.innerHTML = 'Bonus: als je dit leest, ben je officieel mijn <b>favoriete mens</b>. 🎉';
        document.getElementById('type').after(extra);
      }
    });

    /* Ontvang kusjes */
    function kissRain(){
      const total = document.body.classList.contains('reduce-motion') ? 12 : 42;
      for (let i=0;i<total;i++){
        const s = document.createElement('span');
        s.textContent = Math.random()>0.5 ? '💋' : '😘';
        s.style.position='fixed';
        s.style.left = Math.random()*100 + 'vw';
        s.style.top = '-10px';
        s.style.fontSize = (18 + Math.random()*22) + 'px';
        s.style.transition = 'transform 3s linear, opacity 3s';
        s.style.zIndex = 6;
        document.body.append(s);
        requestAnimationFrame(() => {
          s.style.transform = `translateY(${110+Math.random()*20}vh)`;
          s.style.opacity = '0';
        });
        setTimeout(() => s.remove(), 3200);
      }
    }
    document.getElementById('openBtn').addEventListener('click', () => {
      kissRain();
      dropHearts(20);
      showToast('Kusjesregen! 😘');
      try { navigator.vibrate?.(50); } catch {}
    });

    /* Delen */
    document.getElementById('shareBtn').addEventListener('click', async () => {
      const title = document.title;
      const text = 'Voor jou 💫 — een kleine digitale liefdesbrief';
      const url = location.href;
      if (navigator.share) {
        try { await navigator.share({title, text, url}); } catch {}
      } else {
        try { await navigator.clipboard.writeText(url); showToast('Link gekopieerd 📋'); } catch { showToast('Kon link niet kopiëren'); }
      }
    });

    /* Intro -> App overgang */
    const intro = document.getElementById('intro');
    const appCard = document.getElementById('card');

    function burst(x,y){
      const N = 18;
      for(let i=0;i<N;i++){
        const b = document.createElement('div');
        b.className='burst-star';
        const a = (Math.PI*2) * (i/N) + Math.random()*0.7;
        const d = 30 + Math.random()*70;
        b.style.left = (x) + 'px';
        b.style.top  = (y) + 'px';
        b.style.setProperty('--tx', `${Math.cos(a)*d}px`);
        b.style.setProperty('--ty', `${Math.sin(a)*d}px`);
        document.body.appendChild(b);
        setTimeout(()=> b.remove(), 720);
      }
    }

    const startBtn = document.getElementById('startBtn');
    startBtn.addEventListener('click', (e) => {
      const rect = intro.getBoundingClientRect();
      const x = e.clientX || (rect.left + rect.width/2);
      const y = e.clientY || (rect.top + rect.height/2);
      intro.style.setProperty('--cx', x + 'px');
      intro.style.setProperty('--cy', y + 'px');
      burst(x,y);
      shootingStar();
      intro.classList.add('explode');

      setTimeout(()=> {
        appCard.classList.add('app-enter');
        document.getElementById('main').focus?.();
        if (!document.body.classList.contains('reduce-motion')) {
          setTimeout(()=> startAmbientHearts(), 600);
          startShooting();
        }
      }, 300);

      setTimeout(()=> { intro.style.display='none'; }, 950);
    });

    // Focus op startknop bij laden
    window.addEventListener('load', () => startBtn.focus());

    // Pagina-visibility: pauzeer animatie-intervals
    document.addEventListener('visibilitychange', () => {
      if (document.hidden) { stopAmbientHearts(); stopShooting(); }
      else if (!document.body.classList.contains('reduce-motion')) { startAmbientHearts(); startShooting(); }
    });

    // Reduced motion: toggle + respect user setting
    const rmToggle = document.getElementById('rmToggle');
    function applyReducedMotion(on){
      document.body.classList.toggle('reduce-motion', !!on);
      try { localStorage.setItem('reducedMotion', on ? '1' : '0'); } catch {}
      if (on) { stopAmbientHearts(); stopShooting(); }
      else if (!document.hidden) { startAmbientHearts(); startShooting(); }
    }
    (function initRM(){
      const mq = window.matchMedia('(prefers-reduced-motion: reduce)');
      let val = '0';
      try { val = localStorage.getItem('reducedMotion') ?? (mq.matches ? '1' : '0'); } catch { val = mq.matches ? '1' : '0'; }
      rmToggle.checked = val === '1';
      applyReducedMotion(val === '1');
      mq.addEventListener?.('change', (e)=>{ if (!localStorage.getItem('reducedMotion')) applyReducedMotion(e.matches); });
    })();
    rmToggle.addEventListener('change', (e)=> applyReducedMotion(e.target.checked));

    if (location.hash === '#brief') {
      setTimeout(() => document.getElementById('brief')?.scrollIntoView({behavior:'smooth'}), 800);
    }
  </script>
</body>
</html>
